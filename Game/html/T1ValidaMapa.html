<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>T1ValidaMapa</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jo&#227;o Carlos Oliveira Vale &lt;a100697@alunos.uminho.pt&gt;; &lt;carlosvalejcov@gmail.com&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">T1ValidaMapa</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validablocos">validablocos</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validablocosaux">validablocosaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:mergelists">mergelists</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [[<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]]</li><li class="src short"><a href="#v:testbool">testbool</a> :: [[<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:validaporta">validaporta</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:portaaux">portaaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>]</li><li class="src short"><a href="#v:validaCaixaFlutua">validaCaixaFlutua</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaCaixa">validaCaixa</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:armazenaCaixaCoord">armazenaCaixaCoord</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:armazenaCaixaCoord1">armazenaCaixaCoord1</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:armazenaBlocoCoord">armazenaBlocoCoord</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:validavazio">validavazio</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validavazioaux">validavazioaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:medidas">medidas</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; (Int, Int)</li><li class="src short"><a href="#v:omitidos">omitidos</a> :: (Int, Int) -&gt; [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validabase">validabase</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:justBlocks">justBlocks</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:justxBlocks">justxBlocks</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [Int]</li><li class="src short"><a href="#v:blocksbycolumn">blocksbycolumn</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:superGroup">superGroup</a> :: (Eq a, Ord a) =&gt; [(a, b)] -&gt; [(a, [b])]</li><li class="src short"><a href="#v:superGroupSort">superGroupSort</a> :: [(Int, [Int])] -&gt; [(Int, [Int])]</li><li class="src short"><a href="#v:order">order</a> :: [(Int, [Int])] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]</li><li class="src short"><a href="#v:mainfunction">mainfunction</a> :: [(Int, [Int])] -&gt; Bool</li><li class="src short"><a href="#v:testeauxiliar">testeauxiliar</a> :: [Int] -&gt; [Int] -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="doc"><h1><strong>Validar Blocos</strong></h1></div></div><div class="top"><p class="src"><a id="v:validablocos" class="def">validablocos</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validablocos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="T1ValidaMapa.html#v:validablocos" title="T1ValidaMapa">validablocos</a></code> retorna um <code>Bool</code> se o mapa n&#227;o tiver <em>pecas</em> nas mesmas
coordenadas. Sendo composta por 5 auxiliares da seguinte forma:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validablocos [(Bloco,(5,5)),(Caixa,(5,5))]
</code></strong>False
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validablocos [(Bloco,(0,1)),(Bloco,(1,1))]
</code></strong>True
</pre><h2>Auxiliares</h2></div></div><div class="top"><p class="src"><a id="v:validablocosaux" class="def">validablocosaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:validablocosaux" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o usada para simplificar a lista
devolvendo apenas uma lista com as <code><a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a></code></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validablocosaux [(Bloco,(5,2)),(Caixa,(3,3))]
</code></strong>[(5,2),(3,3)]
</pre></div></div><div class="top"><p class="src"><a id="v:mergelists" class="def">mergelists</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [[<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]] <a href="#v:mergelists" class="selflink">#</a></p><div class="doc"><p>Faz um <code>group</code> na lista composta apenas por
coordenadas de modo a juntar numa s&#243; lista.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>mergelists [(2,1),(5,1),(2,1)]
</code></strong>[[(2,1),(2,1)],[5,1]]
</pre></div></div><div class="top"><p class="src"><a id="v:testbool" class="def">testbool</a> :: [[<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>]] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool <a href="#v:testbool" class="selflink">#</a></p><div class="doc"><p>Ligada &#224; fun&#231;&#227;o anterior <code><a href="T1ValidaMapa.html#v:testbool" title="T1ValidaMapa">testbool</a></code>, mede o <em>tamanho</em> da
lista obtida por <code>mergelist</code> e o da obtida por <code><a href="T1ValidaMapa.html#v:validablocosaux" title="T1ValidaMapa">validablocosaux</a></code>.
Em caso de resultado diferente, devolve um <em><code>False</code></em></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>testbool [[(2,1)],[(3,1),(3,1)]] [(3,1),(2,1),(3,1)]
</code></strong>False
</pre><h1><strong>Validar Porta</strong></h1></div></div><div class="top"><p class="src"><a id="v:validaporta" class="def">validaporta</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validaporta" class="selflink">#</a></p><div class="doc"><p>Composta por uma auxiliar, <code><a href="T1ValidaMapa.html#v:validaporta" title="T1ValidaMapa">validaporta</a></code> permite concluir se 
existe <strong>uma e uma s&#243;</strong> <code><a href="T0Dados.html#v:Porta" title="T0Dados">Porta</a></code> no mapa.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[(Bloco,(3,2)),(Porta,(2,2))]
</code></strong>True
</pre><h2>Auxiliar</h2></div></div><div class="top"><p class="src"><a id="v:portaaux" class="def">portaaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>] <a href="#v:portaaux" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:portaaux" title="T1ValidaMapa">portaaux</a></code> devolve uma lista em que as pe&#231;as s&#227;o iguais 
a <code><a href="T0Dados.html#v:Porta" title="T0Dados">Porta</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>portaaux [(Bloco,(2,1))]
</code></strong>[ ]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>portaaux [(Bloco,(2,1)),(Porta,(2,2))]
</code></strong>[Porta] 
</pre><h1><strong>Validar Caixas</strong></h1></div></div><div class="top"><p class="src"><a id="v:validaCaixaFlutua" class="def">validaCaixaFlutua</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validaCaixaFlutua" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que avalia se nenhuma <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> flutua, ou seja, se todas as pe&#231;as <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> 
t&#234;m por baixo outra <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> <strong>ou</strong> um <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code> e se a <strong>ultima</strong> <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> est&#225; em cima de um <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validaCaixaFlutua [(Bloco,(1,2)),(Caixa,(1,1)),(Bloco,(2,3)),(Vazio,(4,5)),(Caixa,(2,2)),(Caixa,(2,1)),(Vazio,(0,0)),(Bloco,(0,2))]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validaCaixaFlutua [(Vazio,(0,0)),(Vazio,(0,1)),(Bloco,(0,2)),(Bloco,(1,2)),(Bloco,(2,2)),(Caixa,(2,1)),(Vazio,(3,2)),(Caixa,(3,1))]
</code></strong>False
</pre><h2>Auxiliares</h2></div></div><div class="top"><p class="src"><a id="v:validaCaixa" class="def">validaCaixa</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool <a href="#v:validaCaixa" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe a lista de coordendas das pe&#231;as <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code>, 
a lista de <em>coordenadas</em> de <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code>, <strong>subtraindo</strong> uma unidade a <strong>y</strong>,
e a lista de <em>coordenadas</em> das pe&#231;as <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code> <strong>subtraindo</strong> uma
unidade a <strong>y</strong>. A partir destas listas, testa se <strong>nenhuma</strong> 
<code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> flutua.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validaCaixa [(1,0),(2,1),(2,0)] [(1,0),(2,1),(2,0)] [(1,1),(2,2),(0,1)]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validaCaixa [(2,1),(3,1)] [(2,0),(3,0)] [(0,1),(1,1),(2,1)]
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:armazenaCaixaCoord" class="def">armazenaCaixaCoord</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:armazenaCaixaCoord" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que <strong>armazena</strong> as <em>coordenadas</em> de todas as pe&#231;as <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> do mapa.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaCaixaCoord [(Bloco,(1,2)),(Caixa,(1,1)),(Bloco,(2,3)),(Vazio,(4,5)),(Caixa,(2,2)),(Caixa,(2,1)),(Vazio,(0,0)),(Bloco,(0,2))]
</code></strong>[(1,1),(2,2),(2,1)]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaCaixaCoord [(Vazio,(0,0)),(Vazio,(0,1)),(Bloco,(0,2)),(Bloco,(1,2)),(Bloco,(2,2)),(Caixa,(2,1)),(Vazio,(3,2)),(Caixa,(3,1))]
</code></strong>[(2,1),(3,1)]
</pre></div></div><div class="top"><p class="src"><a id="v:armazenaCaixaCoord1" class="def">armazenaCaixaCoord1</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:armazenaCaixaCoord1" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que <strong>armazena</strong> as <em>coordenadas</em> de toda a <code><a href="T0Dados.html#v:Caixa" title="T0Dados">Caixa</a></code> do mapa,
<strong>subtraindo-lhes</strong> 1 unidade a <strong>y</strong>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaCaixaCoord1 [(Bloco,(1,2)),(Caixa,(1,1)),(Bloco,(2,3)),(Vazio,(4,5)),(Caixa,(2,2)),(Caixa,(2,1)),(Vazio,(0,0)),(Bloco,(0,2))]
</code></strong>[(1,0),(2,1),(2,0)]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaCaixaCoord1 [(Vazio,(0,0)),(Vazio,(0,1)),(Bloco,(0,2)),(Bloco,(1,2)),(Bloco,(2,2)),(Caixa,(2,1)),(Vazio,(3,2)),(Caixa,(3,1))]
</code></strong>[(2,0),(3,0)]
</pre></div></div><div class="top"><p class="src"><a id="v:armazenaBlocoCoord" class="def">armazenaBlocoCoord</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:armazenaBlocoCoord" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que armazena as <em>coordenadas</em> de todo o <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code> do mapa,
<strong>subtraindo-lhes</strong> 1 unidade a <strong>y</strong>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaBlocoCoord [(Bloco,(1,2)),(Caixa,(1,1)),(Bloco,(2,3)),(Vazio,(4,5)),(Caixa,(2,2)),(Caixa,(2,1)),(Vazio,(0,0)),(Bloco,(0,2))]
</code></strong>[(1,1),(2,2),(0,1)]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>armazenaBlocoCoord [(Vazio,(0,0)),(Vazio,(0,1)),(Bloco,(0,2)),(Bloco,(1,2)),(Bloco,(2,2)),(Caixa,(2,1)),(Vazio,(3,2)),(Caixa,(3,1))]
</code></strong>[(0,1),(1,1),(2,1)]
</pre><h1><strong>Validar Vazio</strong></h1></div></div><div class="top"><p class="src"><a id="v:validavazio" class="def">validavazio</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validavazio" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o, composta por 3 auxiliares, testa se existe <strong>pelo menos</strong>
um <code><a href="T0Dados.html#v:Vazio" title="T0Dados">Vazio</a></code> no mapa.
Caso exista um <code><a href="T0Dados.html#v:Vazio" title="T0Dados">Vazio</a></code> definido no mapa, a fun&#231;&#227;o devolve 
logo um <code>True</code>. Caso contr&#225;rio, a fun&#231;&#227;o ir&#225; testar se 
existe <code><a href="T0Dados.html#v:Vazio" title="T0Dados">Vazio</a></code> por omiss&#227;o.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validavazio [(Bloco,(0,0)),(Bloco,(1,0)),(Bloco,(2,1))]
</code></strong>True
</pre><h2>Auxiliares</h2></div></div><div class="top"><p class="src"><a id="v:validavazioaux" class="def">validavazioaux</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Int -&gt; Int <a href="#v:validavazioaux" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o ir&#225; contar o n&#250;mero de <code><a href="T0Dados.html#v:Vazio" title="T0Dados">Vazio</a></code> fornecidos 
ao mapa.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validavazioaux [(Bloco,(5,9)),(Caixa,(10,5)),(Vazio,(4,2)),(Vazio,(3,3)),(Bloco,(2,9))] 0
</code></strong>2
</pre></div></div><div class="top"><p class="src"><a id="v:medidas" class="def">medidas</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; (Int, Int) <a href="#v:medidas" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="T1ValidaMapa.html#v:medidas" title="T1ValidaMapa">medidas</a></code> mede o tamanho do mapa em <strong>x</strong> e em <strong>y</strong>
para auxiliar a fun&#231;ao seguinte e permitir descobrir se existe
<code><a href="T0Dados.html#v:Vazio" title="T0Dados">Vazio</a></code> <strong>declarados por omiss&#227;o</strong>. </p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>medidas [(Bloco,(5,9)),(Caixa,(10,5)),(Vazio,(4,2)),(Vazio,(3,3)),(Bloco,(2,9))]
</code></strong>(11,10)
</pre></div></div><div class="top"><p class="src"><a id="v:omitidos" class="def">omitidos</a> :: (Int, Int) -&gt; [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:omitidos" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:omitidos" title="T1ValidaMapa">omitidos</a></code> calcula a &#225;rea do mapa com a fun&#231;&#227;o <code><a href="T1ValidaMapa.html#v:medidas" title="T1ValidaMapa">medidas</a></code> anterior
e compara ao n&#250;mero de pe&#231;as <strong>declaradas</strong>. Caso a diferen&#231;a
seja diferente de 0, <code><a href="T1ValidaMapa.html#v:omitidos" title="T1ValidaMapa">omitidos</a></code> devolve um <code>True</code> .</p><h1><strong>validabase</strong></h1></div></div><div class="top"><p class="src"><a id="v:validabase" class="def">validabase</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; Bool <a href="#v:validabase" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o mais complexa, constituida por <strong>7</strong> fun&#231;&#245;es auxiliares,
testa a <strong>base do mapa</strong>, <strong>n&#227;o</strong> podendo haver espa&#231;os vazios, impedindo quedas.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validabase [(Bloco,(0,0)),(Bloco,(1,0)),(Bloco,(2,1)),(Bloco(3,0))]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validabase [(Bloco,(0,0)),(Bloco,(2,0)),(Bloco,(2,1)),(Bloco(3,0))]
</code></strong>False
</pre><h2>Auxiliares</h2></div></div><div class="top"><p class="src"><a id="v:justBlocks" class="def">justBlocks</a> :: [(<a href="T0Dados.html#t:Peca" title="T0Dados">Peca</a>, <a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>)] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:justBlocks" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:justBlocks" title="T1ValidaMapa">justBlocks</a></code>, tal como o nome indica, simplifica a lista, <em>devolvendo apenas</em>
uma lista com as <strong>coordenadas</strong> das pe&#231;as <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code>. </p></div></div><div class="top"><p class="src"><a id="v:justxBlocks" class="def">justxBlocks</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; [Int] <a href="#v:justxBlocks" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:justxBlocks" title="T1ValidaMapa">justxBlocks</a></code> simplifica a fun&#231;&#227;o simplificada, de modo a devolver 
uma lista <em>apenas com os <strong>x</strong> das pe&#231;as <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code></em>.</p></div></div><div class="top"><p class="src"><a id="v:blocksbycolumn" class="def">blocksbycolumn</a> :: [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] -&gt; Bool <a href="#v:blocksbycolumn" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="T1ValidaMapa.html#v:blocksbycolumn" title="T1ValidaMapa">blocksbycolumn</a></code> permite testar se em <em>cada coluna</em>,
existe <strong>pelo menos</strong> um <code><a href="T0Dados.html#v:Bloco" title="T0Dados">Bloco</a></code> devolvendo um <code>Bool</code>.</p></div></div><div class="top"><p class="src"><a id="v:superGroup" class="def">superGroup</a> :: (Eq a, Ord a) =&gt; [(a, b)] -&gt; [(a, [b])] <a href="#v:superGroup" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:superGroup" title="T1ValidaMapa">superGroup</a></code> &#233; fun&#231;ao muito especifica que converte os pares com <strong>x</strong> igual, num unico 
par com <strong>x</strong>, e com os <strong>y</strong> concatenados numa s&#243; lista.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>superGroup [(0,1),(1,3),(0,2)]
</code></strong>[(0,[1,2]),(1,[3])]
</pre></div></div><div class="top"><p class="src"><a id="v:superGroupSort" class="def">superGroupSort</a> :: [(Int, [Int])] -&gt; [(Int, [Int])] <a href="#v:superGroupSort" class="selflink">#</a></p><div class="doc"><p><code><a href="T1ValidaMapa.html#v:superGroupSort" title="T1ValidaMapa">superGroupSort</a></code> &#233; uma fun&#231;ao que <strong>ordena</strong> a lista dentro do par, ou seja, 
ordena os <strong>y</strong> por ordem <em>decrescente</em>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>superGroupSort [(1,[6,2,4,8,5]),(3,[51,2,4,5,4])]
</code></strong>[(1,[8,6,5,4,2]),(3,[51,5,4,4,2])]
</pre></div></div><div class="top"><p class="src"><a id="v:order" class="def">order</a> :: [(Int, [Int])] -&gt; [<a href="T0Dados.html#t:Coordenadas" title="T0Dados">Coordenadas</a>] <a href="#v:order" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;ao devolve as coordenadas com maior <strong>y</strong> de <em>cada coluna</em>, ou seja,
de cada lista dada no <em>segundo</em> elemento de cada par.
No entanto, caso haja um <strong>muro</strong> ou queda, esta fun&#231;&#227;o ir&#225;
devolver mais que um <strong>y</strong> pois se trata de uma grande parede
que <strong>n&#227;o</strong> pode ter buraco.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>order [(0,[9,7,1]),(1,[7,6,5,4])]
</code></strong>[(0,9),(1,7),(1,6),(1,5)]
</pre></div></div><div class="top"><p class="src"><a id="v:mainfunction" class="def">mainfunction</a> :: [(Int, [Int])] -&gt; Bool <a href="#v:mainfunction" class="selflink">#</a></p><div class="doc"><p>Esta &#233; a fun&#231;&#227;o principal, pois ir&#225; testar se existe uma <em>liga&#231;&#227;o</em> 
em toda a base, ou seja, <strong>n&#227;o h&#225; espa&#231;os vazios</strong> l&#225;. Para isso, ir&#225; ser sempre testado, para todos
os casos poss&#237;veis, se o <strong>y</strong> de <strong>x</strong> est&#225; na lista dos <strong>y</strong> para <strong>x+1</strong>, ou seja, se no <strong>x</strong> a seguir h&#225;
alguma continuidade de ch&#227;o. Caso haja, devolve um <code>True</code>, caso contr&#225;rio, devolve um <code>False</code>!</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>mainfunction [(0,[4])(1,[4,5,6]),(2,[7])]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>mainfunction [(0,[4])(1,[4,5,6]),(2,[8])]
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:testeauxiliar" class="def">testeauxiliar</a> :: [Int] -&gt; [Int] -&gt; Bool <a href="#v:testeauxiliar" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o testa se um certo <strong>y</strong> em <strong>x</strong> se encontra na lista de <strong>y</strong> quando <strong>x+1</strong> para saber ent&#227;o se existe
continua&#231;&#227;o de mapa! </p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>